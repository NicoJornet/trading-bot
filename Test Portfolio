"""
TEST SIMPLE - V√©rifie que portfolio.json est bien lu
"""

import json
import os

PORTFOLIO_FILE = "portfolio.json"

def main():
    print("="*60)
    print("üîç TEST DE LECTURE PORTFOLIO.JSON")
    print("="*60)
    
    # V√©rifier si le fichier existe
    if not os.path.exists(PORTFOLIO_FILE):
        print(f"‚ùå Fichier {PORTFOLIO_FILE} non trouv√©!")
        print(f"   R√©pertoire actuel: {os.getcwd()}")
        print(f"   Fichiers pr√©sents: {os.listdir('.')}")
        return
    
    print(f"‚úÖ Fichier {PORTFOLIO_FILE} trouv√©")
    
    # Lire le fichier
    with open(PORTFOLIO_FILE, 'r') as f:
        portfolio = json.load(f)
    
    print(f"\nüìä CONTENU DU PORTFOLIO:")
    print(f"   Cash: {portfolio.get('cash', 'N/A')}‚Ç¨")
    print(f"   Positions: {len(portfolio.get('positions', {}))}")
    
    print(f"\nüìÇ D√âTAIL DES POSITIONS:")
    for ticker, pos in portfolio.get("positions", {}).items():
        print(f"\n   {ticker}:")
        print(f"      entry_price_eur: {pos.get('entry_price_eur', 'N/A')}")
        print(f"      shares: {pos.get('shares', 'N/A')}")
        print(f"      pyramided: {pos.get('pyramided', 'N/A')}")
        print(f"      days_zero_score: {pos.get('days_zero_score', 'N/A')} ‚Üê IMPORTANT")
    
    # Test sp√©cifique pour SLV
    print(f"\nüéØ TEST SP√âCIFIQUE SLV:")
    if "SLV" in portfolio.get("positions", {}):
        slv = portfolio["positions"]["SLV"]
        days_zero = slv.get("days_zero_score", 0)
        print(f"   days_zero_score = {days_zero}")
        
        if days_zero > 0:
            warning = f"‚ö†Ô∏è{days_zero}j"
            print(f"   ‚úÖ Warning devrait afficher: {warning}")
        else:
            print(f"   ‚ùå days_zero_score est 0 ou absent!")
    else:
        print("   ‚ùå SLV non trouv√© dans le portfolio!")
    
    print("\n" + "="*60)

if __name__ == "__main__":
    main()
